<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" horizontalScrollPolicy="off">
	<mx:Script>
	<![CDATA[ 

     import mx.controls.Alert;
     import mx.collections.*;
     import flash.events.Event;
     import mx.controls.DataGrid;
     
     override public function set data(value:Object):void
     {
        if(value != null)
        {
           super.data = value;
           
           setDataProvider();
           //show the comboBox
           if(value.@idSamplePrepMethod != null)
           {
               choices.visible=true;
               labelChoices.visible=false;
           }
           //hide the comboBox and show the label
           else
           {
               choices.visible=false;
               labelChoices.visible=true;
           }
           selectChoice();
        }   
     }
     
     private function setDataProvider():void {
     	if (choices.dataProvider == null) {
			choices.dataProvider = new XMLListCollection(parentApplication.manageDictionaries.lastResult.Dictionary.(@className == 'hci.gnomex.model.SamplePrepMethod').DictionaryEntry);
     		
     	}
     	
     }
     
     private function selectChoice():void {
        choices.selectedIndex = -1;
        if (data == null || data.@idSamplePrepMethod == null) {
        	return;
        }
        for(var i:Number = 0; i < choices.dataProvider.length; i++) {
        	if(choices.dataProvider[i].@value == data.@idSamplePrepMethod) {
                  choices.selectedIndex = i;
                  break;
             }
        }
    	
     }     
     public function changeHandler(event:Event): void
     {
         data.@idSamplePrepMethod=choices.selectedItem.@value;
         IList(DataGrid(owner).dataProvider).itemUpdated(choices.selectedItem);
     }


  ]]> 
  </mx:Script>
  <mx:ComboBox id="choices" labelField="@display" width="100%" creationComplete="setDataProvider();selectChoice();" change="changeHandler(event)" /> 
  <mx:Label id="labelChoices" text="{choices.selectedItem.@display}" x="5" /> 
	
</mx:Canvas>
