<?xml version="1.0" encoding="utf-8"?>
<mx:TitleWindow xmlns:mx="http://www.adobe.com/2006/mxml" layout="vertical" title="{'Edit Price ' + billingPrice.@description}" 
	width="260" height="100" defaultButton="{saveButton}">
   
   <mx:HTTPService             
    id="saveBillingPrice" 
    url="SaveBillingPrice.gx"
    destination="saveBillingPrice" 
    resultFormat="e4x"
    result="onSaveBillingPrice(event)"
    fault="parentApplication.onFailHttpRequest('Failed to save price', event)"
    method="POST"
    useProxy="false">
    <mx:request>
    	<idBillingPrice>{this.billingPrice.@idBillingPrice}</idBillingPrice>
    	<unitPrice>{this.unitPrice.text}</unitPrice>
    </mx:request>
   </mx:HTTPService> 

<mx:Script>
	<![CDATA[
		import mx.rpc.events.FaultEvent;
		import mx.rpc.events.ResultEvent;
		import mx.managers.PopUpManager;
		import mx.controls.Alert;   
		
		[Bindable]
		public var billingPrice:Object;
		
	    private function save():void {
			saveBillingPrice.send();		
		}	
		
		private function onSaveBillingPrice(event:ResultEvent):void {
			if (saveBillingPrice.lastResult.name() == "SUCCESS") {
				parentApplication.dictionaryManager.reload("hci.gnomex.model.BillingPrice");
				parentApplication.navBillingView.refresh();  
				PopUpManager.removePopUp(this);
			} else {
				Alert.show("An error occurred while saving the billing price.");
			}			
		}			
		
	]]>
</mx:Script>

	<mx:HBox width="100%">
		<mx:HBox height="100%" verticalGap="0" width="100%" verticalAlign="middle" horizontalAlign="center">
			<mx:Label text="Unit price:"/>
			<mx:TextInput id="unitPrice" width="80" text="{billingPrice.@unitPrice}" textAlign="right"/>
		</mx:HBox>
	</mx:HBox>
	<mx:ControlBar horizontalAlign="right">
		<mx:Button label="Save" id="saveButton" click="save()" enabled="true" icon="@Embed(source='../../assets/action_save.gif')"/>
		<mx:Button label="Cancel" click="{mx.managers.PopUpManager.removePopUp(this)}"/>
	</mx:ControlBar>
	
</mx:TitleWindow>
